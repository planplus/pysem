# 结构方程模型

## 结构方程模型基础
目前，大家可能只熟悉统计学的探索性使用，如描述性统计均值、回归和探索性因子分析，现在将向大家介绍一种使用统计模型的新方法。这个方法的重点是测试假设模型，其中对模型的参数施加了某些“过度识别”的约束。 其目的是测试具有这些约束条件的模型是否拟合给到的数据。在统计均值中，最接近的例子是对零假设的检验，即均值等于研究人员预先指定的一个特定值。探索是指简单地估计一个变量的匀值而不加任何约束，而不是使估计成为可能的最小约束。在回归中，我们估计回归系数而不对它们进行约束。在探索性因子分析中，我们估计因子载荷和因子相关性，只施加必要的最小约束来获得唯一值。假设检验包括预先指定的某些参数，并对这些值进行测试。现在，我们不会只讨论假设检验，但假设检验非常重要，当我们开始思考结构方程模型时大家需要将其牢记心中。

在大多数情况下，除了假设的参数约束值外，在结构方程模型中还可能存在估计的参数，因为研究人员不知道要将它们约束为什么值。但是模型需要足够完备（给所有参数赋值）才能去测试。模型测试包括从模型参数（既包括约束的也包括估计的）中得到的可观测变量的再生协方差矩阵与观测协方差矩阵的比较，和无一漏掉的拟合。因此，我们通过在约束参数条件下估计未知参数来完备不完备特定模型。但是估计参数不是结构方程模型的核心目的。这是因为它们取值取决于对模型中其他参数施加的约束，如果没有恰当地指定约束，无论通过估计技术为它们赋何值都会有偏差。因此再生协方差矩阵
$$
\mathit{\Sigma = GB^{*-1}\Gamma^*\Phi\Gamma^{*\prime}GB^{*\prime-1}G^{\prime}}
$$
与样本协方差矩阵 $S$ （未施加过度识别约束）比较，确定这些矩阵之间的差异是否是偶然造成的。首先我们需要建立起上面矩阵和概念对我们的意义。

## 路径图

首先，结构方程模型的复杂性需要一种清晰的方法来表示它们。结构方程模型的奠基人Sewell Wright（1921），发明了路径图来表示结构方程模型。图5.1展示了用路径图形式描述结构方程模型。路径图是一个有向图。图中的*外显*变量(*Manifest* variables)用正方形（有时是矩形）表示，变量名写在矩形内。*潜在*变量(*Latent* variables)用圆形（有时是椭圆）表示。直接因果路径用从因变量指向果变量的单头箭头表示。变量间的协方差用双箭头表示。几乎只有外生变量间的协方差才会显示出来。图中的*外生*变量有单头箭头指出，没有箭头指入，表示变量系统的因果输入。*内生*变量有箭头指入，是系统外生变量的结果或系统内其他内生变量的原因。可观测外生变量用 $x^{\prime}$ 表示（图5.1中没有可观测外生变量）。潜在外生变量用 $\xi^{\prime}$ 表示。可观测内生变量用 $y^{\prime}$ 表示。

![图5.1](_media/fig5.1.png)
<p align="center"><b>图5.1</b> 用路径图表示的结构方程模型。方框表示外显变量，圆圈表示潜在变量。潜变量的扰动未加圆圈。单箭头表示因果路径。双箭头表示协方差。每个因果路径都有一个结构参数与其关联。</p>

每个直接因果路径都与一个*结构化系数*关联，表示因变量对果变量的直接因果*效用*。效用表示因变量改变一个单位对果变量影响多少或者因变量的数量有多少按比例转移到果变量。从外生变量到内生变量的路径结构化系数记为 $\gamma^{\prime}$。内生变量到另一个内生变量的路径结构化系数记为 $\alpha^{\prime}$。当一组变量之间可能存在箭头但又没有箭头时，便是两个变量没有因果联系，因此对应的结构化系数为0。因此路径图中保留什么非常重要。声明一个变量不是另一个变量的因通常是我们对模型施加识别和可测试约束的方式。

扰动用 $\epsilon^{\prime}$ 表示。扰动到其对应内生变量的路径结构化系数记作 $\delta^{\prime}$。因果路径的结构化系数的下标从左到右，先是箭头指向变量的下标，然后是箭头开始变量的下标。

图5.1有2个潜在外生变量和2个潜在内生变量。2个潜在外生变量相互关联，有双箭头将他们连接，并有协方差 $\phi12$。潜在内生因变量 $\xi_1$ 是 $\eta_1$ 和 $\eta_2$ 的因。潜在内生变量 $\xi_2$ 是 $\eta_2$ 的因。每一个潜在变量，不管是内生的还是外生的，有4个外显指示变量。指示变量和作为指示变量的潜在变量的区别类似于使用不同读数的温度计的区别，例如：汞柱温度计、酒精柱温度计、热电偶温度计、热敏电阻温度计以及热力学温度计，不管哪种，温度计只是指示器。一个最佳实践是对每个潜在变量用至少四个指示变量来过度识别模型的潜在变量，并允许进行封闭和/或自我遏制性测试。还要注意，每个内生变量，无论是外显变量还是潜在变量，都有一个指向它的*干扰变量*。干扰变量代表外部的影响，如测量误差和随机冲击，这些影响与外生变量和/或内生变量对给定内生变量的影响相结合。扰动类似于共同因素分析中的特征因素或经典测试理论中的测量误差。然而，扰动既可以包含系统性误差，也可以包含非系统性误差。它们通常被认为是互不相关的，也与外生变量是不相关的。技术上，扰动也属于外生变量，但与明确命名的外生变量相比，扰动中所包含的内容都不是关注焦点。

要求扰动互不相关，类似于局部独立条件，其中将某个外生变量作为条件使得内生变量相互条件独立。在以某个外生变量作为条件后内生变量的唯一变化来自取决于扰动。要求扰动与外生变量不相关意味着没有其他隐含的相关原因，模型中没有明确指出，允许对结构化系数进行无偏估计。换句话说，模型代表外部现实的概念，而扰动及其性质应该存在于现实中。当这些假设被违反时，模型可能会受到破坏，并且当数据看上去吻合时会产生误导性的推论。（注：扰动不是残差变量。当残差变量来自一组变量时，可以从其他变量中预测残差变量。它们是数学运算的结果。)在线性模型中，残差必然与分区分量所基于的预测变量不相关。另一方面，扰动代表了模型中没有明确表示的变量的其他原因，在某些情况下，可以想象它们与系统内的某个因变量相互关联。对扰动施加约束，使它们相互不相关，同时与系统的外生变量不相关，必须满足模型所描述的真实世界的情况，从而实现一个封闭的变量系统，在这个封闭系统中，我们可以推断出因果关系，同时还可以无偏地估计出结构化系数。当满足这些约束条件时，残差变量就会等同于扰动。但如果模型所表示的情况不满足约束条件，例如，在扰动中存在与外生变量相关的隐藏关联原因，那么残差就不是真的扰动并且参数估计很可能出现偏差（见 Mulaik, and Brett, 1982, pp. 71–80）。

注意图5.1中变量是如何标号的。外生变量和内生变量分开独立标号。标号从潜在变量开始，然后是外显变量。这里只有2个外生变量 $\xi_1$ 和 $\xi_2$。但有18个内生变量 $\eta_1, \eta_2, y_3, \dots, y_{18}$。扰动变量与其指向的内生标量拥有相同的标号。


## 从路径图到结构方程



## 结构方程模型中的方差和协方差公式



### 代数方法



### 路径追踪规则



## 矩阵方程



